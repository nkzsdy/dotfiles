# true color support
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-ghostty:RGB"
set -ag terminal-overrides ",alacritty:RGB"

# 修飾キー（Shift+Enter等）を正しく伝播させる
set -g extended-keys on
set -as terminal-features 'xterm-ghostty:extkeys'

# vi mode
set-window-option -g mode-keys vi

# enable mouse
set -g mouse on

# prefix: C-q
unbind C-b
set -g prefix C-q
bind C-q send-prefix

# reload config
bind-key r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# resize pane
bind-key -n M-Up resize-pane -U 3
bind-key -n M-Down resize-pane -D 3
bind-key -n M-Left resize-pane -L 3
bind-key -n M-Right resize-pane -R 3

# select pane like vi
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# use pbcopy when Darwin
if-shell -b '[ "$(uname)" = "Darwin" ]' {
  set -s copy-command "pbcopy"
}

# copy-pipe と競合する場合があるので無効化
set -s set-clipboard off

# スクロールバックバッファを大きくする
set-option -g history-limit 10000

# コピーモード中に Vim 風に v で選択範囲を定める
bind -Tcopy-mode-vi v send -X begin-selection

# コピーモード中に Vim 風に y で選択範囲をヤンクしてコピーモードを終了する
bind -Tcopy-mode-vi y send -X copy-pipe-and-cancel

# マウスをドラッグして選択範囲を定め、それをヤンクしてコピーモードを終了する
bind -Tcopy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel

# plugins

# tpm
set -g @plugin 'tmux-plugins/tpm'

# ファイルやURLを開けるようにする
set -g @plugin 'tmux-plugins/tmux-open'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
